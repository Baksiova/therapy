<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--
      BeWellBot frontend
      This file reworks the original KlidBot interface to feel more like a modern, hand‚Äëcrafted application.
      The AI tagline and heavy gradients have been removed in favour of a simple, clean look.  Quick‚Äëreply
      buttons (with smiley icons) have been dropped and the chat area has been tuned for readability.  
    -->
    <title>BeWellBot ‚Äì v√°≈° spoloƒçn√≠k pre wellbeing</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /*
         * Colour palette
         * A fresh, modern palette replaces the original purple gradient.  The primary gradient now uses
         * vibrant blues and aquas for a calmer feel.  Secondary colours are muted neutrals to keep the
         * focus on the conversation rather than the interface.
         */
        :root {
            /* Light Mode Colours */
            --primary-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --primary-color: #4facfe;
            --primary-dark: #007aff;
            --secondary-color: #00f2fe;
            --accent-color: #ffd166;

            /* Success / Warning / Error tones */
            --success-color: #48bb78;
            --warning-color: #ed8936;
            --error-color: #e53e3e;
            --info-color: #4299e1;

            /* Backgrounds */
            --bg-primary: #ffffff;
            --bg-secondary: #f5f7fa;
            --bg-tertiary: #edf2f7;
            --bg-gradient: linear-gradient(180deg, #f5f7fa 0%, #ffffff 100%);

            /* Text */
            --text-primary: #2d3748;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --text-inverse: #ffffff;

            /* Borders / shadows */
            --border-color: #e2e8f0;
            --border-light: #f1f5f9;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.08);
            --shadow-md: 0 4px 15px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.12);

            /* Glass effect */
            --glass-bg: rgba(255, 255, 255, 0.5);
            --glass-border: rgba(255, 255, 255, 0.3);
            --backdrop-blur: blur(10px);

            --font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            --border-radius: 16px;
            --border-radius-lg: 24px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* Dark mode overrides the core palette.  Colours are softened for readability in low light. */
        [data-theme="dark"] {
            --bg-primary: #1a1e24;
            --bg-secondary: #242c36;
            --bg-tertiary: #2e3848;
            --bg-gradient: linear-gradient(180deg, #1a1e24 0%, #2e3848 100%);

            --text-primary: #f7fafc;
            --text-secondary: #d3d7de;
            --text-muted: #8693a6;
            --text-inverse: #1a1e24;

            --border-color: #3a475a;
            --border-light: #2e3848;
            --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 15px rgba(0, 0, 0, 0.4);
            --shadow-lg: 0 10px 40px rgba(0, 0, 0, 0.5);

            --glass-bg: rgba(36, 44, 56, 0.7);
            --glass-border: rgba(69, 82, 102, 0.3);
        }

        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-family);
            background: var(--bg-gradient);
            color: var(--text-primary);
            line-height: 1.6;
            transition: var(--transition);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            overflow: hidden;
        }

        .app-container {
            width: 100%;
            max-width: 900px;
            height: 95vh;
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border: 1px solid var(--glass-border);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-lg);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }

        /* Header styling: simplified branding with modern colours.  AI references removed. */
        .chat-header {
            background: var(--primary-gradient);
            color: var(--text-inverse);
            padding: 20px;
            text-align: center;
            position: relative;
            flex-shrink: 0;
        }

        .header-brand {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 4px;
        }

        /* Logo uses a subtle icon to emphasise conversation without implying AI. */
        .brand-logo {
            width: 32px;
            height: 32px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: 600;
        }

        .chat-header h1 {
            font-size: 22px;
            font-weight: 700;
            letter-spacing: -0.02em;
        }

        /* Subtitle removed ‚Äì leaving blank space for a cleaner look */
        .chat-subtitle {
            font-size: 0;
            opacity: 0;
            height: 0;
            overflow: hidden;
        }

        .header-controls {
            position: absolute;
            top: 20px;
            right: 20px;
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .theme-toggle, .new-session-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: var(--text-inverse);
            padding: 6px 10px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 12px;
            font-family: var(--font-family);
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 4px;
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover, .new-session-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-1px);
        }

        .status-indicator {
            position: absolute;
            top: 20px;
            left: 20px;
            padding: 6px 10px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: var(--transition);
        }

        .status-indicator.connected { background: var(--success-color); color: white; }
        .status-indicator.disconnected { background: var(--error-color); color: white; }
        .status-indicator.connecting { background: var(--warning-color); color: white; }

        .status-indicator::before {
            content: '';
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        /* Main view container */
        .app-main-content {
            flex: 1;
            position: relative;
            overflow: hidden;
            background: var(--bg-secondary);
        }

        .view {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .view.active {
            opacity: 1;
            visibility: visible;
        }

        /* Chat messages list with improved readability */
        .chat-messages {
            flex: 1;
            padding: 24px;
            overflow-y: auto;
            scroll-behavior: smooth;
        }

        .message {
            margin-bottom: 20px;
            display: flex;
            align-items: flex-end;
            gap: 12px;
            animation: slideInMessage 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes slideInMessage {
            from {
                opacity: 0;
                transform: translateY(10px) scale(0.98);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .message.user { justify-content: flex-end; }
        .message.bot { justify-content: flex-start; }

        .message-content {
            max-width: 80%;
            padding: 12px 16px;
            border-radius: var(--border-radius);
            word-wrap: break-word;
            line-height: 1.6;
            font-weight: 400;
            font-size: 15px;
            box-shadow: var(--shadow-sm);
            position: relative;
            transition: var(--transition);
        }

        /* User messages use a light accent background instead of a dramatic gradient. */
        .message.user .message-content {
            background: var(--primary-color);
            color: var(--text-inverse);
            border-bottom-right-radius: 6px;
        }

        /* Bot messages use the primary background for easier reading. */
        .message.bot .message-content {
            background: var(--bg-primary);
            color: var(--text-primary);
            border-bottom-left-radius: 6px;
            border: 1px solid var(--border-light);
        }

        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: var(--shadow-sm);
            background: var(--bg-primary);
            border: 2px solid var(--border-color);
            transition: var(--transition);
        }

        .message-avatar:hover { transform: scale(1.05); }

        .message-avatar svg {
            width: 18px;
            height: 18px;
            fill: var(--primary-color);
        }

        .message.user .message-avatar {
            order: 1;
            background: var(--primary-color);
        }
        .message.user .message-avatar svg { fill: white; }

        /* Quick replies removed: the section exists but hidden to simplify the interface */
        .quick-replies { display: none; }

        /* Input area styling ‚Äì simplified for a cleaner look */
        .chat-input-container {
            padding: 20px 24px;
            background: var(--bg-primary);
            border-top: 1px solid var(--border-color);
            backdrop-filter: blur(10px);
        }

        .chat-input-form {
            display: flex;
            gap: 12px;
            align-items: center;
            position: relative;
        }

        .chat-input {
            flex: 1;
            padding: 14px 18px;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            font-size: 16px;
            background: var(--bg-secondary);
            color: var(--text-primary);
            outline: none;
            transition: var(--transition);
            resize: none;
            min-height: 48px;
            max-height: 120px;
        }

        .chat-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.15);
            background: var(--bg-primary);
        }

        .chat-input:disabled {
            background: var(--bg-tertiary);
            cursor: not-allowed;
            opacity: 0.6;
        }

        .send-button {
            background: var(--primary-gradient);
            color: var(--text-inverse);
            border: none;
            width: 48px;
            height: 48px;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            box-shadow: var(--shadow-sm);
        }

        .send-button svg {
            width: 18px;
            height: 18px;
        }

        .send-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .send-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: scale(1);
        }

        /* Typing indicator preserved but simplified */
        .typing-indicator {
            display: none;
            align-items: center;
            margin: 0 24px 16px;
            gap: 12px;
            animation: slideInMessage 0.3s ease;
        }

        .typing-dots {
            background: var(--bg-primary);
            border-radius: 20px;
            padding: 12px 16px;
            display: flex;
            gap: 6px;
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-light);
        }

        .dot {
            width: 6px;
            height: 6px;
            background: var(--text-muted);
            border-radius: 50%;
            animation: typingBounce 1.4s infinite ease-in-out;
        }

        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typingBounce {
            0%, 80%, 100% {
                transform: scale(0.8);
                opacity: 0.5;
            }
            40% {
                transform: scale(1.2);
                opacity: 1;
            }
        }

        /* Error messages use subtle red accents, consistent with the new palette */
        .error-message {
            background: rgba(229, 62, 62, 0.1);
            color: var(--error-color);
            padding: 14px 18px;
            border-radius: var(--border-radius);
            margin: 0 24px 20px;
            border-left: 4px solid var(--error-color);
            animation: slideInMessage 0.3s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .welcome-message {
            text-align: center;
            color: var(--text-muted);
            padding: 16px;
            font-size: 14px;
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            margin: 24px;
            border: 1px solid var(--border-light);
        }

        /* Daily affirmation styling ‚Äì light box with a subtle coloured bar at the top */
        .daily-affirmation {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.05) 0%, rgba(0, 242, 254, 0.05) 100%);
            border: 1px solid rgba(79, 172, 254, 0.2);
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 24px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .daily-affirmation::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-gradient);
        }

        .affirmation-text {
            font-size: 16px;
            font-weight: 500;
            color: var(--text-primary);
            margin-bottom: 6px;
            font-style: italic;
        }

        .affirmation-author {
            font-size: 12px;
            color: var(--text-muted);
        }

        /* Progress section styling ‚Äì uses primary colours for progress indication */
        .progress-section {
            background: var(--bg-primary);
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 24px;
            border: 1px solid var(--border-light);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .progress-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--text-primary);
        }

        .progress-badge {
            background: var(--primary-gradient);
            color: white;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 6px;
        }

        .progress-fill {
            height: 100%;
            background: var(--primary-gradient);
            border-radius: 4px;
            transition: width 0.6s ease;
        }

        .progress-text {
            font-size: 12px;
            color: var(--text-muted);
            text-align: center;
        }

        /* Tools and navigation remain largely unchanged from the original design. */
        #toolsView { padding: 24px; overflow-y: auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; align-content: start; }
        .tool-card { background: var(--bg-primary); border-radius: var(--border-radius); padding: 24px; display: flex; align-items: center; gap: 20px; cursor: pointer; transition: var(--transition); border: 1px solid var(--border-color); position: relative; overflow: hidden; }
        .tool-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 4px; background: var(--primary-gradient); transform: scaleX(0); transition: var(--transition); transform-origin: left; }
        .tool-card:hover { transform: translateY(-4px); box-shadow: var(--shadow-md); }
        .tool-card:hover::before { transform: scaleX(1); }
        .tool-card-icon { width: 56px; height: 56px; background: var(--primary-gradient); border-radius: 14px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; box-shadow: var(--shadow-sm); }
        .tool-card-icon svg { fill: white; width: 28px; height: 28px; }
        .tool-card-content h3 { font-size: 16px; font-weight: 600; margin-bottom: 6px; color: var(--text-primary); }
        .tool-card-content p { font-size: 14px; color: var(--text-secondary); line-height: 1.4; }

        .app-nav { display: flex; background: var(--bg-primary); border-top: 1px solid var(--border-color); padding: 12px 0; flex-shrink: 0; backdrop-filter: blur(10px); }
        .nav-btn { flex: 1; background: none; border: none; color: var(--text-muted); display: flex; flex-direction: column; align-items: center; gap: 4px; cursor: pointer; transition: var(--transition); font-family: var(--font-family); padding: 6px; border-radius: 12px; margin: 0 4px; position: relative; }
        .nav-btn.active, .nav-btn:hover { color: var(--primary-color); background: rgba(79, 172, 254, 0.1); }
        .nav-btn svg { width: 22px; height: 22px; fill: currentColor; transition: var(--transition); }
        .nav-btn.active svg { transform: scale(1.1); }
        .nav-btn span { font-size: 11px; font-weight: 500; }

        /* Hide overflow scrollbars where possible */
        .chat-messages::-webkit-scrollbar, .overlay-container::-webkit-scrollbar { width: 6px; }
        .chat-messages::-webkit-scrollbar-track, .overlay-container::-webkit-scrollbar-track { background: var(--bg-tertiary); border-radius: 3px; }
        .chat-messages::-webkit-scrollbar-thumb, .overlay-container::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 3px; }
        .chat-messages::-webkit-scrollbar-thumb:hover, .overlay-container::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            body { padding: 0; align-items: stretch; }
            .app-container { width: 100%; height: 100vh; border-radius: 0; max-width: none; }
            .chat-header { padding: 18px 12px; }
            .header-controls { right: 12px; }
            .status-indicator { left: 12px; }
            .chat-messages { padding: 16px; }
            .chat-input-container { padding: 16px; }
            #toolsView { grid-template-columns: 1fr; padding: 16px; }
            .message-content { max-width: 85%; }
        }
    </style>
</head>
<body data-theme="light">
    <div class="app-container">
        <header class="chat-header">
            <div class="status-indicator connecting" id="statusIndicator">
                <span>Prip√°janie...</span>
            </div>
            
            <div class="header-controls">
                <button class="theme-toggle" id="themeToggle" aria-label="Prepn√∫≈• tmav√Ω re≈æim">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="5"/>
                        <path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                    </svg>
                    <span class="theme-text">Svetl√Ω</span>
                </button>
                <button class="new-session-btn" onclick="startNewSession()" id="newSessionBtn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
                        <path d="M21 3v5h-5"/>
                    </svg>
                    <span>Nov√Ω chat</span>
                </button>
            </div>

            <div class="header-brand">
                <div class="brand-logo">üí¨</div>
                <h1 id="headerTitle">BeWellBot</h1>
            </div>
            <p id="headerSubtitle" class="chat-subtitle"></p>
        </header>

        <main class="app-main-content">
            <!-- Chat View -->
            <div id="chatView" class="view active">
                <div class="chat-messages" id="chatMessages">
                    <div class="welcome-message">
                        Vitajte v BeWellBot ‚Äì va≈°om bezpeƒçnom priestore pre wellbeing a du≈°evn√∫ pohodu.
                    </div>
                    


                    <div class="progress-section">
                        <div class="progress-header">
                            <div class="progress-title">üéØ T√Ω≈ædenn√Ω pokrok</div>
                            <div class="progress-badge">3/7 dn√≠</div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 43%"></div>
                        </div>
                        <div class="progress-text">Skvele pokraƒçujte! U≈æ 3 dni za sebou ste si na≈°li ƒças na wellbeing.</div>
                    </div>
                    
                    <div class="message bot">
                        <div class="message-avatar">
                            <svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12,2A10,10,0,0,0,2,12a9.89,9.89,0,0,0,2.3,6.32l-1.5,4.35a1,1,0,0,0,1.26,1.26l4.35-1.5A10,10,0,1,0,12,2Zm4,11H14.5a.5.5,0,0,1,0-1H16a1,1,0,0,1,0,2Zm-8,0H6.5a.5.5,0,0,1,0-1H8a1,1,0,0,1,0,2Zm5.5,3.5c-2.58,0-4.83-1.63-5.5-4h11C16.33,14.87,14.08,16.5,11.5,16.5Z"/>
                            </svg>
                        </div>
                        <div class="message-content">
                            Ahoj! Som BeWellBot, v√°≈° spoloƒçn√≠k na ceste za lep≈°√≠m wellbeingom. Ako sa dnes c√≠tite?
                        </div>
                    </div>
                </div>
                <div class="typing-indicator" id="typingIndicator">
                    <div class="message-avatar">
                        <svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12,2A10,10,0,0,0,2,12a9.89,9.89,0,0,0,2.3,6.32l-1.5,4.35a1,1,0,0,0,1.26,1.26l4.35-1.5A10,10,0,1,0,12,2Zm4,11H14.5a.5.5,0,0,1,0-1H16a1,1,0,0,1,0,2Zm-8,0H6.5a.5.5,0,0,1,0-1H8a1,1,0,0,1,0,2Zm5.5,3.5c-2.58,0-4.83-1.63-5.5-4h11C16.33,14.87,14.08,16.5,11.5,16.5Z"/>
                        </svg>
                    </div>
                    <div class="typing-dots">
                        <div class="dot"></div>
                        <div class="dot"></div>
                        <div class="dot"></div>
                    </div>
                </div>
                <div class="chat-input-container">
                    <form class="chat-input-form" id="chatForm">
                        <textarea class="chat-input" id="messageInput" placeholder="Zdieƒæajte svoje my≈°lienky..." maxlength="500" disabled rows="1"></textarea>
                        <button type="submit" class="send-button" id="sendButton" disabled aria-label="Odosla≈• spr√°vu">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="22" y1="2" x2="11" y2="13"/>
                                <polygon points="22,2 15,22 11,13 2,9 22,2"/>
                            </svg>
                        </button>
                    </form>
                </div>
            </div>
            <!-- Tools view remains largely as original; only the header will update via JS on navigation. -->
            <div id="toolsView" class="view">
                <div class="tool-card" onclick="startBreathingExercise()">
                    <div class="tool-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,6C8.69,6 6,8.69 6,12C6,15.31 8.69,18 12,18C15.31,18 18,15.31 18,12C18,8.69 15.31,6 12,6Z"/>
                        </svg>
                    </div>
                    <div class="tool-card-content">
                        <h3>üå¨Ô∏è Riaden√© d√Ωchanie</h3>
                        <p>4-7-8, Box breathing a ƒèal≈°ie techniky pre okam≈æit√© upokojenie a redukciu stresu.</p>
                    </div>
                </div>
                <div class="tool-card" onclick="startStressTracking()">
                    <div class="tool-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M14.5,9A1.5,1.5 0 0,1 16,10.5A1.5,1.5 0 0,1 14.5,12A1.5,1.5 0 0,1 13,10.5A1.5,1.5 0 0,1 14.5,9M9.5,9A1.5,1.5 0 0,1 11,10.5A1.5,1.5 0 0,1 9.5,12A1.5,1.5 0 0,1 8,10.5A1.5,1.5 0 0,1 9.5,9M12,17.23C10.25,17.23 8.71,16.5 7.81,15.42L9.23,14C9.68,14.72 10.75,15.23 12,15.23C13.25,15.23 14.32,14.72 14.77,14L16.19,15.42C15.29,16.5 13.75,17.23 12,17.23Z"/>
                        </svg>
                    </div>
                    <div class="tool-card-content">
                        <h3>üìä Mood Tracker</h3>
                        <p>Denn√© sledovanie n√°lady, energie a stresu s personalizovan√Ωmi insights a trendmi.</p>
                    </div>
                </div>
                <div class="tool-card" onclick="openPssAssessment()">
                    <div class="tool-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M19,3H5C3.89,3 3,3.89 3,5V19C3,20.11 3.9,21 5,21H19C20.11,21 21,20.11 21,19V5C21,3.89 20.11,3 19,3M19,5V19H5V5H19M17,17H7V15H17V17M17,13H7V11H17V13M17,9H7V7H17V9Z"/>
                        </svg>
                    </div>
                    <div class="tool-card-content">
                        <h3>üß† PSS-10 Assessment</h3>
                        <p>Vedecky validovan√Ω dotazn√≠k na meranie vn√≠man√©ho stresu za posledn√Ω mesiac.</p>
                    </div>
                </div>
                <div class="tool-card" onclick="openJournalingTool()">
                    <div class="tool-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
                        </svg>
                    </div>
                    <div class="tool-card-content">
                        <h3>üìù Mindful Journal</h3>
                        <p>Dennn√© zapisovanie my≈°lienok, em√≥ci√≠ a vƒèaƒçnosti pre lep≈°ie sebapoznanie.</p>
                    </div>
                </div>
                <div class="tool-card" onclick="openMeditationGuide()">
                    <div class="tool-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12,2A10,10 0 0,1 22,12A10,10 0 0,1 12,22A10,10 0 0,1 2,12A10,10 0 0,1 12,2M12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20A8,8 0 0,0 20,12A8,8 0 0,0 12,4M12,6A6,6 0 0,1 18,12A6,6 0 0,1 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6Z"/>
                        </svg>
                    </div>
                    <div class="tool-card-content">
                        <h3>üßò Guided Meditation</h3>
                        <p>Kr√°tke medit√°cie pre r√¥zne situ√°cie - sp√°nok, stres, s√∫stredenie, sebal√°ska.</p>
                    </div>
                </div>
                <div class="tool-card" onclick="openCrisisResources()">
                    <div class="tool-card-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                            <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,17H11V15H13V17M13,13H11V7H13V13Z"/>
                        </svg>
                    </div>
                    <div class="tool-card-content">
                        <h3>üÜò Kr√≠zov√° pomoc</h3>
                        <p>Okam≈æit√Ω pr√≠stup k linke pomoci, kr√≠zov√Ωm kontaktom a n√∫dzov√Ωm technik√°m.</p>
                    </div>
                </div>
            </div>
            <!-- Dashboard view placeholder ‚Äì unchanged from original design. -->
            <div id="dashboardView" class="view dashboard-view">
                <!-- Dashboard content would go here -->
            </div>
        </main>
        <nav class="app-nav">
            <button class="nav-btn active" data-view="chatView" data-title="BeWellBot" data-subtitle="" aria-label="Chat">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4A2,2 0 0,0 20,2M20,16H5.2L4,17.2V4H20V16M6,9H18V11H6V9M6,12H15V14H6V12M6,6H18V8H6V6Z"/>
                </svg>
                <span>Chat</span>
            </button>
            <button class="nav-btn" data-view="toolsView" data-title="üõ†Ô∏è Wellbeing n√°stroje" data-subtitle="Interakt√≠vne cviƒçenia a techniky pre du≈°evn√∫ pohodu" aria-label="Tools">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M12,15.5A3.5,3.5 0 0,1 8.5,12A3.5,3.5 0 0,1 12,8.5A3.5,3.5 0 0,1 15.5,12A3.5,3.5 0 0,1 12,15.5M19.43,12.97C19.47,12.65 19.5,12.33 19.5,12C19.5,11.67 19.47,11.34 19.43,11L21.54,9.37C21.73,9.22 21.78,8.95 21.66,8.73L19.66,5.27C19.54,5.05 19.27,4.96 19.05,5.05L16.56,6.05C16.04,5.66 15.5,5.32 14.87,5.07L14.5,2.42C14.46,2.18 14.25,2 14,2H10C9.75,2 9.54,2.18 9.5,2.42L9.13,5.07C8.5,5.32 7.96,5.66 7.44,6.05L4.95,5.05C4.73,4.96 4.46,5.05 4.34,5.27L2.34,8.73C2.22,8.95 2.27,9.22 2.46,9.37L4.57,11C4.53,11.34 4.5,11.67 4.5,12C4.5,12.33 4.53,12.65 4.57,12.97L2.46,14.63C2.27,14.78 2.22,15.05 2.34,15.27L4.34,18.73C4.46,18.95 4.73,19.03 4.95,18.95L7.44,17.94C7.96,18.34 8.5,18.68 9.13,18.93L9.5,21.58C9.54,21.82 9.75,22 10,22H14C14.25,22 14.46,21.82 14.5,21.58L14.87,18.93C15.5,18.68 16.04,18.34 16.56,17.94L19.05,18.95C19.27,19.03 19.54,18.95 19.66,18.73L21.66,15.27C21.78,15.05 21.73,14.78 21.54,14.63L19.43,12.97Z"/>
                </svg>
                <span>N√°stroje</span>
            </button>
            <button class="nav-btn" data-view="dashboardView" data-title="üìà Wellbeing Dashboard" data-subtitle="Va≈°e pokroky, trendy a personalizovan√© insights" aria-label="Dashboard">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path d="M22,21H2V3H4V19H6V17H10V19H12V16H16V19H18V17H22V21M16,8H18V15H16V8M12,2H14V15H12V2M8,9H10V15H8V9M4,11H6V15H4V11Z"/>
                </svg>
                <span>Dashboard</span>
            </button>
        </nav>
    </div>
    <script>
        /*
          The following script is based closely on the original KlidBot frontend.  It retains
          all existing functionality (theme toggling, connection checking, messaging, navigation) but
          updates references to use the new branding (Bewellbot) and removes the now-hidden quick replies
          logic.  New variables (e.g., palette colours) are referenced from CSS rather than hard coded.
        */

        const API_BASE_URL = '';
        const CHECK_CONNECTION_INTERVAL = 30000;
        let isConnected = false;
        let connectionCheckInterval;

        const themeToggle = document.getElementById('themeToggle');
        const themeText = themeToggle.querySelector('.theme-text');
        const sunIcon = `<circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>`;
        const moonIcon = `<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>`;

        function initializeTheme() {
            const savedTheme = localStorage.getItem('bewellbot-theme') || 'light';
            document.body.setAttribute('data-theme', savedTheme);
            updateThemeButton(savedTheme);
        }

        function toggleTheme() {
            const currentTheme = document.body.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            document.body.setAttribute('data-theme', newTheme);
            localStorage.setItem('bewellbot-theme', newTheme);
            updateThemeButton(newTheme);
        }

        function updateThemeButton(theme) {
            const icon = themeToggle.querySelector('svg');
            if (theme === 'dark') {
                icon.innerHTML = sunIcon;
                themeText.textContent = 'Tmav√Ω';
            } else {
                icon.innerHTML = moonIcon;
                themeText.textContent = 'Svetl√Ω';
            }
        }
        themeToggle.addEventListener('click', toggleTheme);

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 120) + 'px';
        }

        async function checkConnection() {
            const statusIndicator = document.getElementById('statusIndicator');
            const messageInput = document.getElementById('messageInput');
            const sendButton = document.getElementById('sendButton');
            try {
                const response = await fetch(`${API_BASE_URL}/health`, { method: 'GET', credentials: 'include' });
                if (response.ok) {
                    isConnected = true;
                    statusIndicator.innerHTML = '<span>Pripojen√©</span>';
                    statusIndicator.className = 'status-indicator connected';
                    messageInput.disabled = false;
                    sendButton.disabled = false;
                    messageInput.placeholder = 'Zdieƒæajte svoje my≈°lienky...';
                } else {
                    throw new Error('Server not healthy');
                }
            } catch (error) {
                isConnected = false;
                statusIndicator.innerHTML = '<span>Odpojen√©</span>';
                statusIndicator.className = 'status-indicator disconnected';
                messageInput.disabled = true;
                sendButton.disabled = true;
                messageInput.placeholder = 'Server nie je dostupn√Ω...';
            }
        }

        function sendQuickReply(message) {
            // Quick replies are hidden; this function is kept for API compatibility but unused.
        }

        async function sendMessage(event) {
            event.preventDefault();
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            if (!message || messageInput.disabled) return;
            if (!isConnected) {
                showError('Nie je mo≈æn√© pripoji≈• sa k serveru. Sk√∫≈°ame znova...');
                checkConnection();
                return;
            }
            addMessage(message, 'user');
            messageInput.value = '';
            autoResize(messageInput);
            document.getElementById('sendButton').disabled = true;
            messageInput.disabled = true;
            showTypingIndicator();
            try {
                const response = await fetch(`${API_BASE_URL}/chat`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    credentials: 'include',
                    body: JSON.stringify({ message: message })
                });
                const data = await response.json();
                hideTypingIndicator();
                if (response.ok) {
                    if (data.response_sequence && data.response_sequence.length > 0) {
                        for (let i = 0; i < data.response_sequence.length; i++) {
                            const msg = data.response_sequence[i];
                            await new Promise(resolve => setTimeout(resolve, i === 0 ? 100 : 800));
                            addMessage(msg.content, 'bot');
                        }
                    } else {
                        showError('Server vr√°til pr√°zdnu odpoveƒè.');
                    }
                } else {
                    throw new Error(data.error || 'Chyba s odpoveƒèou zo servera');
                }
            } catch (error) {
                console.error('Error sending message:', error);
                showError('Chyba siete. Skontrolujte pripojenie a sk√∫ste to znova.');
                await checkConnection();
            } finally {
                hideTypingIndicator();
                if (isConnected) {
                    document.getElementById('sendButton').disabled = false;
                    messageInput.disabled = false;
                    messageInput.focus();
                }
            }
        }

        function addMessage(content, sender) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            const avatarSVG = sender === 'user'
                ? `<svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,2A10,10,0,0,0,2,12A10,10,0,0,0,12,22A10,10,0,0,0,22,12A10,10,0,0,0,12,2ZM12,6a3,3,0,1,1-3,3A3,3,0,0,1,12,6Zm0,14a7,7,0,0,1-7-7c0-2.39,1.95-4.36,4.36-4.36h5.28C17.05,8.64,19,10.61,19,13A7,7,0,0,1,12,20Z"/></svg>`
                : `<svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,2A10,10,0,0,0,2,12a9.89,9.89,0,0,0,2.3,6.32l-1.5,4.35a1,1,0,0,0,1.26,1.26l4.35-1.5A10,10,0,1,0,12,2Zm4,11H14.5a.5.5,0,0,1,0-1H16a1,1,0,0,1,0,2Zm-8,0H6.5a.5.5,0,0,1,0-1H8a1,1,0,0,1,0,2Zm5.5,3.5c-2.58,0-4.83-1.63-5.5-4h11C16.33,14.87,14.08,16.5,11.5,16.5Z"/></svg>`;
            messageDiv.innerHTML = `<div class="message-avatar">${avatarSVG}</div><div class="message-content">${content}</div>`;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showError(message) {
            const chatMessages = document.getElementById('chatMessages');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.innerHTML = `<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/></svg>${message}`;
            chatMessages.appendChild(errorDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
            setTimeout(() => { if (errorDiv.parentNode) errorDiv.remove(); }, 5000);
        }

        function showTypingIndicator() {
            document.getElementById('typingIndicator').style.display = 'flex';
            document.getElementById('chatMessages').scrollTop = document.getElementById('chatMessages').scrollHeight;
        }
        function hideTypingIndicator() { document.getElementById('typingIndicator').style.display = 'none'; }

        async function startNewSession() {
            if (!isConnected) return showError('Nie je mo≈æn√© pripoji≈• sa k serveru.');
            if (!confirm('Naozaj chcete zaƒça≈• nov√∫ konverz√°ciu?')) return;
            try {
                const response = await fetch(`${API_BASE_URL}/new-session`, { method: 'POST', credentials: 'include' });
                if (response.ok) {
                    document.getElementById('chatMessages').innerHTML = `
                        <div class="welcome-message">
                            Vitajte v BeWellBot ‚Äì va≈°om bezpeƒçnom priestore pre wellbeing a du≈°evn√∫ pohodu.
                        </div>
                        <div class="daily-affirmation">
                            <div class="affirmation-text">\"Ka≈æd√Ω de≈à je nov√° pr√≠le≈æitos≈• na rast a sebapoznanie.\"</div>
                            <div class="affirmation-author">‚Äî Dne≈°n√° afirm√°cia</div>
                        </div>
                        <div class="progress-section">
                            <div class="progress-header">
                                <div class="progress-title">üéØ T√Ω≈ædenn√Ω pokrok</div>
                                <div class="progress-badge">1/7 dn√≠</div>
                            </div>
                            <div class="progress-bar"><div class="progress-fill" style="width: 14%"></div></div>
                            <div class="progress-text">Nov√Ω zaƒçiatok! Dnes je prv√Ω de≈à va≈°ej wellbeing cesty.</div>
                        </div>
                        <div class="message bot">
                            <div class="message-avatar"><svg fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,2A10,10,0,0,0,2,12a9.89,9.89,0,0,0,2.3,6.32l-1.5,4.35a1,1,0,0,0,1.26,1.26l4.35-1.5A10,10,0,1,0,12,2Zm4,11H14.5a.5.5,0,0,1,0-1H16a1,1,0,0,1,0,2Zm-8,0H6.5a.5.5,0,0,1,0-1H8a1,1,0,0,1,0,2Zm5.5,3.5c-2.58,0-4.83-1.63-5.5-4h11C16.33,14.87,14.08,16.5,11.5,16.5Z"/></svg></div>
                            <div class="message-content">Ahoj! Som BeWellBot, v√°≈° spoloƒçn√≠k na ceste za lep≈°√≠m wellbeingom. Ako sa dnes c√≠tite?</div>
                        </div>
                    `;
                    addMessage('Nov√° konverz√°cia bola spusten√°. Som pripraven√Ω poƒç√∫va≈• a podpori≈• v√°s! ‚ú®', 'bot');
                } else {
                    throw new Error('Failed to start new session');
                }
            } catch (error) {
                showError(error.message);
            }
        }

        function startBreathingExercise() { alert('üå¨Ô∏è Dychov√© cviƒçenie sa ƒçoskoro spust√≠...'); }
        function startStressTracking() { alert('üìä Mood Tracker sa ƒçoskoro spust√≠...'); }
        function openPssAssessment() { alert('üß† PSS-10 Assessment sa ƒçoskoro spust√≠...'); }
        function openJournalingTool() { alert('üìù Mindful Journal sa ƒçoskoro spust√≠...'); }
        function openMeditationGuide() { alert('üßò Guided Meditation sa ƒçoskoro spust√≠...'); }
        function openCrisisResources() {
            const crisisMessage = `üÜò KR√çZOV√Å POMOC 24/7:\n\n` +
                `üìû **Okam≈æit√° pomoc:**\n‚Ä¢ 112 - Ties≈àov√© volanie\n‚Ä¢ 155 - Z√°chranka\n‚Ä¢ 158 - Pol√≠cia\n\n` +
                `üíô **Kr√≠zov√© linky:**\n‚Ä¢ 0800 800 566 - Linka d√¥very Nez√°budka\n‚Ä¢ 116 111 - Linka bezpeƒç√≠\n‚Ä¢ www.krizovalinkapomoci.sk\n\n` +
                `Nie ste sami. Pomoc je v≈ædy dostupn√°. üíô`;
            addMessage(crisisMessage, 'bot');
        }

        function initializeNavigation() {
            const navButtons = document.querySelectorAll('.nav-btn');
            const views = document.querySelectorAll('.view');
            const headerTitle = document.getElementById('headerTitle');
            const headerSubtitle = document.getElementById('headerSubtitle');
            const newSessionBtn = document.getElementById('newSessionBtn');
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    navButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
                    const viewId = button.dataset.view;
                    const title = button.dataset.title;
                    const subtitle = button.dataset.subtitle;
                    views.forEach(view => view.classList.remove('active'));
                    document.getElementById(viewId).classList.add('active');
                    headerTitle.textContent = title;
                    headerSubtitle.textContent = subtitle;
                    newSessionBtn.style.display = (viewId === 'chatView') ? 'flex' : 'none';
                });
            });
        }
        document.addEventListener('DOMContentLoaded', function() {
            initializeTheme();
            checkConnection();
            connectionCheckInterval = setInterval(checkConnection, CHECK_CONNECTION_INTERVAL);
            initializeNavigation();
            const chatForm = document.getElementById('chatForm');
            const messageInput = document.getElementById('messageInput');
            chatForm.addEventListener('submit', sendMessage);
            messageInput.addEventListener('input', function() { autoResize(this); });
            messageInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter' && !event.shiftKey) {
                    event.preventDefault();
                    chatForm.dispatchEvent(new Event('submit'));
                }
            });
            setTimeout(() => messageInput.focus(), 100);
        });
        window.addEventListener('beforeunload', () => { if (connectionCheckInterval) clearInterval(connectionCheckInterval); });
        window.addEventListener('focus', () => { const messageInput = document.getElementById('messageInput'); if (!messageInput.disabled) messageInput.focus(); });
    </script>
</body>
</html>
